<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solis Hybrid - –î–∞—à–±–æ—Ä–¥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #2d3748;
            font-size: 2em;
            margin-bottom: 10px;
        }

        .status-bar {
            display: flex;
            gap: 20px;
            align-items: center;
            margin-top: 15px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            background: #f7fafc;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #48bb78;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 48px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .card-icon {
            font-size: 1.8em;
        }

        .card-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #2d3748;
        }

        .sensor-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #f7fafc;
        }

        .sensor-row:last-child {
            border-bottom: none;
        }

        .sensor-label {
            color: #718096;
            font-size: 0.95em;
        }

        .sensor-value {
            font-weight: 600;
            color: #2d3748;
            font-size: 1.1em;
        }

        .sensor-value.positive {
            color: #48bb78;
        }

        .sensor-value.negative {
            color: #f56565;
        }

        .large-value {
            text-align: center;
            padding: 20px 0;
        }

        .large-value .value {
            font-size: 3em;
            font-weight: 700;
            color: #667eea;
        }

        .large-value .unit {
            font-size: 1.2em;
            color: #718096;
            margin-left: 5px;
        }

        .large-value .label {
            font-size: 0.9em;
            color: #a0aec0;
            margin-top: 5px;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e2e8f0;
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78 0%, #38a169 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .controls {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            color: #2d3748;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #e2e8f0;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        button:hover {
            background: #5568d3;
        }

        .error {
            background: #fed7d7;
            color: #c53030;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 1.2em;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.5em;
            }

            .status-bar {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚òÄÔ∏è Solis Hybrid Inverter</h1>
            <div class="status-bar">
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span id="connection-status">–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...</span>
                </div>
                <div class="status-indicator">
                    <span id="esp-address">ESP: ‚Äî</span>
                </div>
                <div class="status-indicator">
                    <span id="inverter-status">‚Äî</span>
                </div>
                <div class="status-indicator">
                    <span id="last-update">–û–Ω–æ–≤–ª–µ–Ω–Ω—è: ‚Äî</span>
                </div>
            </div>
        </header>

        <div id="error-message" class="error" style="display: none;"></div>
        <div id="loading" class="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö...</div>

        <div id="dashboard" style="display: none;">
            <!-- SOC Card -->
            <div class="grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üîã</div>
                        <div class="card-title">–ë–∞—Ç–∞—Ä–µ—è</div>
                    </div>
                    <div class="large-value">
                        <div>
                            <span class="value" id="soc">‚Äî</span>
                            <span class="unit">%</span>
                        </div>
                        <div class="label">–ó–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ—ó (SOC)</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="soc-bar" style="width: 0%;">0%</div>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">–ù–∞–ø—Ä—É–≥–∞</span>
                        <span class="sensor-value" id="batt-voltage">‚Äî V</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">–°—Ç—Ä—É–º</span>
                        <span class="sensor-value" id="batt-current">‚Äî A</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å</span>
                        <span class="sensor-value" id="batt-power">‚Äî W</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</span>
                        <span class="sensor-value" id="batt-temp">‚Äî ¬∞C</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">SOH</span>
                        <span class="sensor-value" id="soh">‚Äî %</span>
                    </div>
                </div>

                <!-- PV Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">‚òÄÔ∏è</div>
                        <div class="card-title">–°–æ–Ω—è—á–Ω—ñ –ø–∞–Ω–µ–ª—ñ</div>
                    </div>
                    <div class="large-value">
                        <div>
                            <span class="value" id="pv-total-power">‚Äî</span>
                            <span class="unit">W</span>
                        </div>
                        <div class="label">–ó–∞–≥–∞–ª—å–Ω–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å</div>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">PV1 –ù–∞–ø—Ä—É–≥–∞</span>
                        <span class="sensor-value" id="pv1-voltage">‚Äî V</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">PV1 –°—Ç—Ä—É–º</span>
                        <span class="sensor-value" id="pv1-current">‚Äî A</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">PV2 –ù–∞–ø—Ä—É–≥–∞</span>
                        <span class="sensor-value" id="pv2-voltage">‚Äî V</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">PV2 –°—Ç—Ä—É–º</span>
                        <span class="sensor-value" id="pv2-current">‚Äî A</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">–ï–Ω–µ—Ä–≥—ñ—è —Å—å–æ–≥–æ–¥–Ω—ñ</span>
                        <span class="sensor-value" id="pv-energy-today">‚Äî kWh</span>
                    </div>
                </div>

                <!-- Grid Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">‚ö°</div>
                        <div class="card-title">–ú–µ—Ä–µ–∂–∞</div>
                    </div>
                    <div class="large-value">
                        <div>
                            <span class="value" id="grid-power">‚Äî</span>
                            <span class="unit">W</span>
                        </div>
                        <div class="label">–ê–∫—Ç–∏–≤–Ω–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å</div>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">–ù–∞–ø—Ä—É–≥–∞</span>
                        <span class="sensor-value" id="grid-voltage">‚Äî V</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">–°—Ç—Ä—É–º</span>
                        <span class="sensor-value" id="grid-current">‚Äî A</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">–ß–∞—Å—Ç–æ—Ç–∞</span>
                        <span class="sensor-value" id="grid-frequency">‚Äî Hz</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">–Ü–º–ø–æ—Ä—Ç —Å—å–æ–≥–æ–¥–Ω—ñ</span>
                        <span class="sensor-value" id="grid-import">‚Äî kWh</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">–ï–∫—Å–ø–æ—Ä—Ç —Å—å–æ–≥–æ–¥–Ω—ñ</span>
                        <span class="sensor-value" id="grid-export">‚Äî kWh</span>
                    </div>
                </div>

                <!-- Load Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üè†</div>
                        <div class="card-title">–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</div>
                    </div>
                    <div class="large-value">
                        <div>
                            <span class="value" id="load-power">‚Äî</span>
                            <span class="unit">W</span>
                        </div>
                        <div class="label">–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è</div>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">Backup –ù–∞–ø—Ä—É–≥–∞</span>
                        <span class="sensor-value" id="backup-voltage">‚Äî V</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">Backup –°—Ç—Ä—É–º</span>
                        <span class="sensor-value" id="backup-current">‚Äî A</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">Backup –ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å</span>
                        <span class="sensor-value" id="backup-power">‚Äî W</span>
                    </div>
                </div>

                <!-- System Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üîß</div>
                        <div class="card-title">–°–∏—Å—Ç–µ–º–∞</div>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —ñ–Ω–≤–µ—Ä—Ç–æ—Ä–∞</span>
                        <span class="sensor-value" id="inverter-temp">‚Äî ¬∞C</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">BMS –õ—ñ–º—ñ—Ç –∑–∞—Ä—è–¥—É</span>
                        <span class="sensor-value" id="bms-charge-limit">‚Äî A</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">BMS –õ—ñ–º—ñ—Ç —Ä–æ–∑—Ä—è–¥—É</span>
                        <span class="sensor-value" id="bms-discharge-limit">‚Äî A</span>
                    </div>
                    <div class="sensor-row">
                        <span class="sensor-label">PV –ï–Ω–µ—Ä–≥—ñ—è –≤—Å—å–æ–≥–æ</span>
                        <span class="sensor-value" id="pv-energy-total">‚Äî kWh</span>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls">
                <h2 style="margin-bottom: 20px; color: #2d3748;">‚öôÔ∏è –ö–µ—Ä—É–≤–∞–Ω–Ω—è</h2>
                <p style="color: #718096; margin-bottom: 20px;">
                    ‚ö†Ô∏è –î–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å ESPHome
                    <br>–î–æ—Å—Ç—É–ø: <a href="http://solis-hybrid-full.local" target="_blank" style="color: #667eea;">http://solis-hybrid-full.local</a>
                </p>
            </div>
        </div>
    </div>

    <script>
        // ‚öôÔ∏è –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø: –í–∫–∞–∂—ñ—Ç—å IP –∞–¥—Ä–µ—Å—É –≤–∞—à–æ–≥–æ ESP32
        // –ó–º—ñ–Ω—ñ—Ç—å —Ü–µ –Ω–∞ IP –∞–¥—Ä–µ—Å—É –∑ –ª–æ–≥—ñ–≤ ESPHome (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: '192.168.0.66')
        const ESP_HOST = '192.168.0.66'; // ‚Üê –ó–ú–Ü–ù–Ü–¢–¨ –ù–ê –í–ê–®–£ IP –ê–î–†–ï–°–£!

        // –ê–±–æ –∑–∞–ª–∏—à—Ç–µ –ø–æ—Ä–æ–∂–Ω—ñ–º –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:
        // const ESP_HOST = window.location.hostname || 'solis-hybrid-full.local';

        const ESP_PORT = 80;
        const API_BASE = `http://${ESP_HOST}:${ESP_PORT}`;
        const UPDATE_INTERVAL = 5000; // 5 —Å–µ–∫—É–Ω–¥

        let updateTimer;

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ ESPHome API
        async function fetchData() {
            try {
                const response = await fetch(`${API_BASE}/text_sensor/`, {
                    mode: 'cors',
                    credentials: 'include'
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                // ESPHome API –ø–æ–≤–µ—Ä—Ç–∞—î –¥–∞–Ω—ñ —É —Ä—ñ–∑–Ω–∏—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
                // –¢—É—Ç –ø–æ–∫–∞–∑–∞–Ω–æ –ø—Ä–∏–∫–ª–∞–¥. –†–µ–∞–ª—å–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ API
                updateConnectionStatus(true);

                // –û–Ω–æ–≤–ª—é—î–º–æ —á–∞—Å –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
                const now = new Date();
                document.getElementById('last-update').textContent =
                    `–û–Ω–æ–≤–ª–µ–Ω–Ω—è: ${now.toLocaleTimeString('uk-UA')}`;

                // –ü–æ–∫–∞–∑—É—î–º–æ –¥–∞—à–±–æ—Ä–¥
                document.getElementById('loading').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';

            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö:', error);
                updateConnectionStatus(false);
                showError(`–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ ${ESP_HOST}. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ ESP32 –¥–æ—Å—Ç—É–ø–Ω–∏–π —ñ CORS –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π.`);
            }
        }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
        function updateConnectionStatus(connected) {
            const statusEl = document.getElementById('connection-status');
            const statusDot = document.querySelector('.status-dot');

            if (connected) {
                statusEl.textContent = '–ü—ñ–¥–∫–ª—é—á–µ–Ω–æ';
                statusDot.style.background = '#48bb78';
            } else {
                statusEl.textContent = '–ù–µ–º–∞—î –∑–≤\'—è–∑–∫—É';
                statusDot.style.background = '#f56565';
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É
        function showError(message) {
            const errorEl = document.getElementById('error-message');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
        }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è —Å–µ–Ω—Å–æ—Ä–∞
        function updateSensor(id, value, unit = '') {
            const el = document.getElementById(id);
            if (el) {
                el.textContent = `${value} ${unit}`.trim();

                // –î–æ–¥–∞—î–º–æ –∫–ª–∞—Å–∏ –¥–ª—è –ø–æ–∑–∏—Ç–∏–≤–Ω–∏—Ö/–Ω–µ–≥–∞—Ç–∏–≤–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
                if (typeof value === 'number') {
                    el.classList.remove('positive', 'negative');
                    if (value > 0) el.classList.add('positive');
                    if (value < 0) el.classList.add('negative');
                }
            }
        }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è SOC –ø—Ä–æ–≥—Ä–µ—Å-–±–∞—Ä—É
        function updateSOC(value) {
            const socBar = document.getElementById('soc-bar');
            const socValue = document.getElementById('soc');

            socBar.style.width = `${value}%`;
            socBar.textContent = `${value}%`;
            socValue.textContent = value;

            // –ú—ñ–Ω—è—î–º–æ –∫–æ–ª—ñ—Ä –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –∑–∞—Ä—è–¥—É
            if (value < 20) {
                socBar.style.background = 'linear-gradient(90deg, #f56565 0%, #e53e3e 100%)';
            } else if (value < 50) {
                socBar.style.background = 'linear-gradient(90deg, #ed8936 0%, #dd6b20 100%)';
            } else {
                socBar.style.background = 'linear-gradient(90deg, #48bb78 0%, #38a169 100%)';
            }
        }

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        async function init() {
            console.log(`–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ ${API_BASE}`);

            // –ü–æ–∫–∞–∑—É—î–º–æ IP –∞–¥—Ä–µ—Å—É ESP32
            document.getElementById('esp-address').textContent = `ESP: http://${ESP_HOST}`;

            // –ü–æ–∫–∞–∑—É—î–º–æ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é
            showError(`
                üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:

                IP –∞–¥—Ä–µ—Å–∞ ESP32: ${ESP_HOST}

                ‚ö†Ô∏è –Ø–∫—â–æ –¥–∞—à–±–æ—Ä–¥ –Ω–µ –ø—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è:
                1. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ ESP32 –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –¥–æ WiFi (–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –≤ ESPHome)
                2. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å ESP32: http://${ESP_HOST}
                3. –Ø–∫—â–æ –Ω–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è - –∑–º—ñ–Ω—ñ—Ç—å IP –∞–¥—Ä–µ—Å—É –≤ —Ä—è–¥–∫—É 472 —Ü—å–æ–≥–æ HTML —Ñ–∞–π–ª—É

                üìù –î–ª—è –∑–º—ñ–Ω–∏ IP –∞–¥—Ä–µ—Å–∏:
                - –í—ñ–¥–∫—Ä–∏–π—Ç–µ dashboard.html –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ
                - –ó–Ω–∞–π–¥—ñ—Ç—å —Ä—è–¥–æ–∫ 472: const ESP_HOST = '${ESP_HOST}';
                - –ó–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à—É IP –∞–¥—Ä–µ—Å—É –∑ –ª–æ–≥—ñ–≤ ESPHome
            `);

            // –ü—Ä–∏–∫–ª–∞–¥ –¥–∞–Ω–∏—Ö –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';

                // –î–µ–º–æ –¥–∞–Ω—ñ
                updateSOC(75);
                updateSensor('batt-voltage', '51.2', 'V');
                updateSensor('batt-current', '12.5', 'A');
                updateSensor('batt-power', '640', 'W');
                updateSensor('batt-temp', '25.5', '¬∞C');
                updateSensor('soh', '98', '%');

                updateSensor('pv-total-power', '3200');
                updateSensor('pv1-voltage', '385.2', 'V');
                updateSensor('pv1-current', '4.15', 'A');
                updateSensor('pv2-voltage', '390.5', 'V');
                updateSensor('pv2-current', '4.05', 'A');
                updateSensor('pv-energy-today', '12.5', 'kWh');

                updateSensor('grid-power', '-500');
                updateSensor('grid-voltage', '230.5', 'V');
                updateSensor('grid-current', '-2.17', 'A');
                updateSensor('grid-frequency', '50.02', 'Hz');
                updateSensor('grid-import', '2.1', 'kWh');
                updateSensor('grid-export', '5.8', 'kWh');

                updateSensor('load-power', '2140');
                updateSensor('backup-voltage', '230.2', 'V');
                updateSensor('backup-current', '9.3', 'A');
                updateSensor('backup-power', '2140', 'W');

                updateSensor('inverter-temp', '42.5', '¬∞C');
                updateSensor('bms-charge-limit', '100', 'A');
                updateSensor('bms-discharge-limit', '100', 'A');
                updateSensor('pv-energy-total', '1245.8', 'kWh');

                document.getElementById('inverter-status').textContent = '–°—Ç–∞—Ç—É—Å: Normal (–î–ï–ú–û)';
                document.getElementById('connection-status').textContent = '–î–ï–ú–û —Ä–µ–∂–∏–º';
            }, 1000);

            // –£–í–ê–ì–ê: –†–µ–∞–ª—å–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ ESP32 –∑–∞–∫–æ–º–µ–Ω—Ç–æ–≤–∞–Ω–æ!
            // ESPHome –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î CORS, —Ç–æ–º—É –ø—Ä—è–º—ñ –∑–∞–ø–∏—Ç–∏ –∑ HTML –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å.
            //
            // –©–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –†–ï–ê–õ–¨–ù–Ü –¥–∞–Ω—ñ - –≤—ñ–¥–∫—Ä–∏–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
            // http://${ESP_HOST}
            //
            // –î–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤: —Ä–æ–∑–∫–æ–º–µ–Ω—Ç—É–π—Ç–µ –Ω–∏–∂—á–µ —è–∫—â–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ CORS proxy:
            // updateTimer = setInterval(fetchData, UPDATE_INTERVAL);
            // fetchData();
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        window.addEventListener('load', init);

        // –ó—É–ø–∏–Ω–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∏ –∑–∞–∫—Ä–∏—Ç—Ç—ñ
        window.addEventListener('beforeunload', () => {
            if (updateTimer) clearInterval(updateTimer);
        });
    </script>
</body>
</html>
